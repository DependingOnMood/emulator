{"version":3,"file":"stateService.min.js","sources":["../stateService.js"],"names":["angular","module","service","$window","$timeout","$log","$rootScope","setPlayMode","_playMode","playMode","undefined","game","setPlayers","sendUpdateUi","setRandomSeed","_randomSeed","randomSeed","playersInfo","actualNumberOfPlayers","randomFromTo","minNumberOfPlayers","maxNumberOfPlayers","i","playerId","push","init","throwError","currentState","lastState","currentVisibleTo","lastVisibleTo","lastMove","turnIndexBeforeMove","turnIndex","endMatchScores","moveNumber","startNewMatch","broadcastUpdateUi","getKeys","object","keys","key","hasOwnProperty","clone","obj","copy","isNull","error","arguments","msg","Array","prototype","join","call","Error","get","field","getMoveForPlayerIndex","playerIndex","move","moveForPlayer","k","length","operation","set","visibleToPlayerIndexes","indexOf","type","value","getStateForPlayerIndex","gameState","visibleTo","result","shuffle","keysCopy","slice","index","removed","splice","from","to","Math","floor","random","processApiOperation","op","setTurn","setRandomInteger","setVisibility","endMatch","toJson","setTurnOrEndMatchCount","scores","shuffledKeys","oldGameState","oldVisibleTo","j","fromKey","toKey","randomValue","getYourPlayerIndex","getMatchState","setMatchState","data","getIntercom","Intercom","getInstance","matchState","intercom","localStorage","setItem","location","toString","emit","gotBroadcastUpdateUi","info","delayedSendUpdateUi","moveForIndex","stateBeforeMove","stateAfterMove","isMoveOk","turnIndexAfterMove","numberOfPlayers","updateUI","yourPlayerIndex","settings","simulateServerDelayMilliseconds","makeMove","operations","seedrandom","setGame","_game","on","getItem","fromJson","isTie","score","getWinnerIndex","winnerIndex","search","this","getTurnIndex","isYourTurn","getEndMatchScores","isWinner","getCurrentTime","window","performance","now","Date","getTime","getLogEntry","args","time","startTime","storeLog","lastLogs","shift","convertLogEntriesToStrings","logs","lines","entry","stringArgs","arg","stringArg","toFixed","getLogs","alwaysLogs","alwaysLog","console","apply","debug","warn","log"],"mappings":"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"}