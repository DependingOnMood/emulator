{"version":3,"file":"stateService.min.js","sources":["../stateService.js"],"names":["angular","module","service","$window","$timeout","$log","$rootScope","setPlayMode","_playMode","playMode","undefined","game","setPlayers","sendUpdateUi","setRandomSeed","_randomSeed","randomSeed","playersInfo","actualNumberOfPlayers","randomFromTo","minNumberOfPlayers","maxNumberOfPlayers","i","playerId","push","init","throwError","currentState","lastState","currentVisibleTo","lastVisibleTo","lastMove","turnIndexBeforeMove","turnIndex","endMatchScores","moveNumber","startNewMatch","broadcastUpdateUi","getKeys","object","keys","key","hasOwnProperty","clone","obj","copy","isNull","error","arguments","msg","Array","prototype","join","call","alert","Error","get","field","getMoveForPlayerIndex","playerIndex","move","moveForPlayer","k","length","operation","set","visibleToPlayerIndexes","indexOf","type","value","getStateForPlayerIndex","gameState","visibleTo","result","shuffle","keysCopy","slice","index","removed","splice","from","to","Math","floor","random","processApiOperation","op","setTurn","setRandomInteger","setVisibility","endMatch","toJson","setTurnOrEndMatchCount","scores","shuffledKeys","oldGameState","oldVisibleTo","j","fromKey","toKey","randomValue","getYourPlayerIndex","getMatchState","setMatchState","data","getIntercom","Intercom","getInstance","matchState","intercom","localStorage","setItem","location","toString","emit","gotBroadcastUpdateUi","info","delayedSendUpdateUi","moveForIndex","stateBeforeMove","stateAfterMove","isMoveOk","turnIndexAfterMove","numberOfPlayers","updateUI","yourPlayerIndex","settings","simulateServerDelayMilliseconds","makeMove","operations","seedrandom","setGame","_game","on","getItem","fromJson","isTie","score","getWinnerIndex","winnerIndex","search","this","getTurnIndex","isYourTurn","getEndMatchScores","isWinner"],"mappings":"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"}