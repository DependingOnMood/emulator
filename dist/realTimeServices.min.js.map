{"version":3,"file":"realTimeServices.min.js","sources":["realTimeServices.js"],"names":["angular","module","service","checkRandomIndex","randomIndex","undefined","Error","Math","seedrandom","originalRandom","random","randomValues","seed","this","setSeed","_seed","i","length","randomFromTo","from","to","floor","doNotUseInYourGameGetOriginalMathRandom","$window","$log","$timeout","messageService","resizeGameAreaService","randomService","sendMessageNowToCanvasController","index","msg","canvasController","canvasControllers","gotMessage","gotStartMatch","gotEndMatch","toJson","sendMessageToCanvasController","simulateDelay","canvasControllersMessageQueue","push","_msg","shift","init","params","createCanvasController","canvasWidth","canvasHeight","gameDeveloperEmail","bodyStr","maxPlayers","canvases","document","body","innerHTML","canvas","getElementById","safeCanvasController","messagePasser","p","isOngoing","createSingleDeviceMatchController","playerIndex","singleDeviceSendMessage","isReliable","playersInfo","checkSendMessage","fromPlayerIndex","message","simulateLosingUnreliableMsgs","singleDeviceEndMatch","endMatchScores","info","endMatch","sendReliableMessage","sendUnreliableMessage","getBestRowsCols","numberOfPlayers","windowWidth","window","innerWidth","windowHeight","innerHeight","maxScale","bestRowsCols","rows","cols","totalWidth","totalHeight","scaleW","scaleH","scale","min","changeCanvasesDispay","style","display","setWidthToHeight","canvasPercentWidth","canvasPercentHeight","margin","row","col","top","left","width","height","handleGotStartMatch","handleGotEndMatch","isSingleDevice","yourPlayerIndex","randomSeed","matchController","handleGotMessage","handleMessage","lastMessage","console","log","checkMultiDeviceMessage","sendMessage","urlParams","query","location","search","substr","result","split","forEach","part","item","decodeURIComponent","sendLocalTestingStartMatch","numberOfLocalTestPlayers","playerId","isLocalTesting","addMessageListener","gameReady","parent","Number","testPlayers","delay","loseUnreliable","$rootScope","gameUrl","toString","postMessage","listener","addEventListener","event","source","$apply","data","factory","exception","cause","error","exceptionString","stackTrace","stack","emailJavaScriptError","emailSubject","emailBody","_widthToHeight","widthToHeight","oldSizes","rescale","round2","num","round","gameArea","doc","newWidthToHeight","keepMargin","marginTop","marginLeft","position","onresize","onorientationchange","setInterval"],"mappings":"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"}