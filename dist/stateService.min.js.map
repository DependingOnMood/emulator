{"version":3,"file":"stateService.min.js","sources":["../stateService.js"],"names":["angular","module","service","$window","$timeout","$log","$rootScope","setPlayMode","_playMode","playMode","undefined","game","setPlayers","sendUpdateUi","playersInfo","i","maxNumberOfPlayers","playerId","push","init","throwError","currentState","lastState","currentVisibleTo","lastVisibleTo","lastMove","turnIndexBeforeMove","turnIndex","endMatchScores","startNewMatch","broadcastUpdateUi","getKeys","object","keys","key","hasOwnProperty","clone","obj","copy","isNull","error","arguments","msg","Array","prototype","join","call","alert","Error","get","field","getMoveForPlayerIndex","playerIndex","move","moveForPlayer","k","length","operation","set","visibleToPlayerIndexes","indexOf","type","value","getStateForPlayerIndex","gameState","visibleTo","result","shuffle","keysCopy","slice","index","Math","floor","random","removed","splice","processApiOperation","op","setTurn","setRandomInteger","setVisibility","endMatch","toJson","setTurnOrEndMatchCount","scores","shuffledKeys","oldGameState","oldVisibleTo","j","fromKey","toKey","from","to","randomValue","getYourPlayerIndex","getMatchState","setMatchState","data","getIntercom","Intercom","getInstance","matchState","intercom","localStorage","setItem","location","toString","emit","gotBroadcastUpdateUi","info","delayedSendUpdateUi","moveForIndex","stateBeforeMove","stateAfterMove","isMoveOk","turnIndexAfterMove","numberOfPlayers","updateUI","yourPlayerIndex","settings","simulateServerDelayMilliseconds","makeMove","operations","setGame","_game","on","getItem","fromJson","isTie","score","getWinnerIndex","winnerIndex","search","this","getTurnIndex","isYourTurn","getEndMatchScores","isWinner"],"mappings":"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"}