{"version":3,"file":"stateService.min.js","sources":["../stateService.js"],"names":["angular","module","service","$window","$timeout","$log","$rootScope","setPlayMode","_playMode","playMode","undefined","game","setPlayers","sendUpdateUi","setRandomSeed","_randomSeed","randomSeed","playersInfo","i","maxNumberOfPlayers","playerId","push","init","throwError","currentState","lastState","currentVisibleTo","lastVisibleTo","lastMove","turnIndexBeforeMove","turnIndex","endMatchScores","moveNumber","startNewMatch","broadcastUpdateUi","getKeys","object","keys","key","hasOwnProperty","clone","obj","copy","isNull","error","arguments","msg","Array","prototype","join","call","alert","Error","get","field","getMoveForPlayerIndex","playerIndex","move","moveForPlayer","k","length","operation","set","visibleToPlayerIndexes","indexOf","type","value","getStateForPlayerIndex","gameState","visibleTo","result","shuffle","keysCopy","slice","index","Math","floor","random","removed","splice","processApiOperation","op","setTurn","setRandomInteger","setVisibility","endMatch","toJson","setTurnOrEndMatchCount","scores","shuffledKeys","oldGameState","oldVisibleTo","j","fromKey","toKey","from","to","randomValue","getYourPlayerIndex","getMatchState","setMatchState","data","getIntercom","Intercom","getInstance","matchState","intercom","localStorage","setItem","location","toString","emit","gotBroadcastUpdateUi","info","delayedSendUpdateUi","moveForIndex","stateBeforeMove","stateAfterMove","isMoveOk","turnIndexAfterMove","numberOfPlayers","updateUI","yourPlayerIndex","settings","simulateServerDelayMilliseconds","makeMove","operations","seedrandom","setGame","_game","on","getItem","fromJson","isTie","score","getWinnerIndex","winnerIndex","search","this","getTurnIndex","isYourTurn","getEndMatchScores","isWinner"],"mappings":"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"}