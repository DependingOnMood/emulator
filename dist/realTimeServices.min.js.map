{"version":3,"file":"realTimeServices.min.js","sources":["realTimeServices.js"],"names":["angular","module","service","checkRandomIndex","randomIndex","undefined","Error","Math","seedrandom","originalRandom","random","randomValues","seed","this","setSeed","_seed","i","length","randomFromTo","from","to","floor","doNotUseInYourGameGetOriginalMathRandom","$window","$log","$timeout","messageService","resizeGameAreaService","randomService","sendMessageNowToCanvasController","index","msg","canvasController","canvasControllers","gotMessage","gotStartMatch","gotEndMatch","toJson","sendMessageToCanvasController","simulateDelay","canvasControllersMessageQueue","push","_msg","shift","init","params","createCanvasController","canvasWidth","canvasHeight","gameDeveloperEmail","bodyStr","maxPlayers","canvases","document","body","innerHTML","canvas","getElementById","messagePasser","createSingleDeviceMatchController","playerIndex","singleDeviceSendMessage","isReliable","playersInfo","checkSendMessage","fromPlayerIndex","message","simulateLosingUnreliableMsgs","singleDeviceEndMatch","endMatchScores","info","endMatch","sendReliableMessage","sendUnreliableMessage","getBestRowsCols","numberOfPlayers","windowWidth","window","innerWidth","windowHeight","innerHeight","maxScale","bestRowsCols","rows","cols","totalWidth","totalHeight","scaleW","scaleH","scale","min","changeCanvasesDispay","style","display","setWidthToHeight","canvasPercentWidth","canvasPercentHeight","margin","row","col","top","left","p","width","height","handleGotStartMatch","isSingleDevice","yourPlayerIndex","randomSeed","matchController","handleGotMessage","handleGotEndMatch","handleMessage","lastMessage","console","log","checkMultiDeviceMessage","sendMessage","urlParams","query","location","search","substr","result","split","forEach","part","item","decodeURIComponent","sendLocalTestingStartMatch","numberOfLocalTestPlayers","playerId","isLocalTesting","addMessageListener","gameReady","parent","Number","testPlayers","delay","loseUnreliable","$rootScope","gameUrl","toString","postMessage","listener","addEventListener","event","source","$apply","data","factory","exception","cause","error","exceptionString","stackTrace","stack","emailJavaScriptError","emailSubject","emailBody","_widthToHeight","widthToHeight","oldSizes","rescale","round2","num","round","gameArea","doc","newWidthToHeight","keepMargin","marginTop","marginLeft","position","onresize","onorientationchange","setInterval"],"mappings":"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"}